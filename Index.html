<!DOCTYPE html>
<html>
<head>
  <title>GLN Extractor</title>
  <style>
    :root {
      --background-color: #f0f0f0;
      --text-color: #000000;
      --button-background-color: #0074d9;
      --button-text-color: #ffffff;
    }

    .dark-mode {
      --background-color: #222222;
      --text-color: #ffffff;
      --button-background-color: #ffffff;
      --button-text-color: #000000;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }

    button {
      background-color: var(--button-background-color);
      color: var(--button-text-color);
    }
  </style>
</head>
<body>
  <h1>GLN Extractor</h1>
  <form>
    <label for="file-input">Select a Word document to extract GLNs from:</label>
    <input type="file" id="file-input" name="file-input">
    <br>
    <input type="radio" id="output-as-list" name="output" value="list" checked>
    <label for="output-as-list">Output as list</label>
    <br>
    <input type="radio" id="output-as-sql" name="output" value="sql">
    <label for="output-as-sql">Output as SQL</label>
    <br>
    <button type="button" onclick="extractGLNs()">Extract GLNs</button>
    <button type="button" onclick="toggleDarkMode()">Toggle dark mode</button>
  </form>
  <br>
  <div id="output"></div>

  <script>
    function extractGLNs() {
      const fileInput = document.getElementById("file-input");
      const file = fileInput.files[0];
      const outputOption = document.querySelector('input[name="output"]:checked').value;

      const formData = new FormData();
      formData.append("file", file);
      formData.append("outputOption", outputOption);

      fetch("/extract-glns", {
        method: "POST",
        body: formData
      })
        .then(response => response.text())
        .then(data => {
          document.getElementById("output").textContent = data;
        });
    }

    function toggleDarkMode() {
      const body = document.querySelector("body");
      body.classList.toggle("dark-mode");
    }
  </script>
</body>
</html>
